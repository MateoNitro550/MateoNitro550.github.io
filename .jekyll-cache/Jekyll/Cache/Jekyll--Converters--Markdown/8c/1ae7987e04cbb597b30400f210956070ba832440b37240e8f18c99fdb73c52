I"Ú <p>El d√≠a de hoy vamos a resolver la m√°quina <em>Vulnversity</em> de <em>Try Hack Me</em>. Esta es una m√°quina f√°cil tanto en la intrusi√≥n como en la escalada de privilegios, por lo que no supondr√° ninguna complicaci√≥n a la hora de realizarla.</p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2021-09-27-Vulnversity---Try-Hack-Me/1.png" alt="" /></p>

<h3 id="fase-de-reconocimiento"><a href="#header-3"></a>Fase De Reconocimiento</h3>

<p>Primeramente vamos a utilizar la herramienta <em>Nmap</em> para determinar que puertos est√°n abiertos as√≠ como identificar la versi√≥n y servicios que corren en el activo. Es importante aclarar que as√≠ como menciona la plataforma de <em>Try Hack Me</em>, existen diversos <a href="https://www.stationx.net/nmap-cheat-sheet/">cheatsheets</a> que podemos encontrar en internet, cuyo principal objetivo es darnos a conocer cuales son todas las posiblidades que nos ofrece la herramienta.</p>

<p>No obstante, recordemos que varias herramientas por defecto tienen incluidas un <code class="language-plaintext highlighter-rouge">manual</code> o con un comando <code class="language-plaintext highlighter-rouge">--help</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>man nmap
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap --help
</code></pre></div></div>

<p>Entre las preguntas que nos realiza la plataforma en esta primera fase, se encuentra:</p>

<ul>
  <li>¬øCu√°ntos puertos abiertos existen?</li>
  <li>¬øQu√© sistema operativo tiene la m√°quina ante la que nos estamos enfrentando?</li>
  <li>¬øEn qu√© puerto est√° corriendo el servidor web?</li>
  <li>¬øQu√© versi√≥n de squid proxy est√° corriendo en la m√°quina?</li>
</ul>

<p>Todas estas preguntas son f√°ciles de responder si realizamos un buen escaneo con <em>Nmap</em>.</p>

<p>Para determinar que puertos est√°n abiertos podemos realizar lo siguiente:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap -p- --open -T5 -v -n &lt;direcci√≥n IP&gt; -oG allPorts
</code></pre></div></div>

<p>Y en caso de que el escaneo tarde demasiado en completar, tenemos esta otra alternativa:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn &lt;direcci√≥n IP&gt; -oG allPorts
</code></pre></div></div>

<p>A continuaci√≥n se explican los par√°metros utilizados en el escaneo de puertos con <em>Nmap</em>:</p>

<ul>
  <li>p - Escanea todo el rango de puertos (65535 en total)</li>
  <li>open - Nos indica todos aquellos puertos que est√°n abiertos (o posiblemente abiertos)</li>
  <li>T5 - La plantilla de temporizado nos permite agilizar nuestro escaneo, este valor puede ir desde 0 hasta 5, cabe aclarar que a mayor sea el valor de la plantilla, ‚Äúgeneraremos m√°s ruido  ‚Äú, pero no pasa nada ¬øno? Al fin y al cabo estamos practicando en un entorno controlado y aqu√≠ somos todos <code class="language-plaintext highlighter-rouge">White Hat</code></li>
  <li>v - <em>Verbose</em>, reporta lo encontrado por consola</li>
  <li>n - No aplicar <em>resoluci√≥n DNS</em></li>
  <li>sS - Escaneo <em>TCP SYN</em></li>
  <li>min-rate - Emitir paquetes no m√°s lentos que -valor- por segundo</li>
  <li>vvv - Triple <em>verbose</em>, para obtener mayor informaci√≥n por consola</li>
  <li>Pn - No aplicar <em>host discovery</em></li>
  <li>oG - Exportar el escaneo en formato ‚Äú<em>grepeable</em>‚Äù</li>
</ul>

<p>Para determinar la versi√≥n y servicios que corren bajo estos puertos podemos realizar lo siguiente:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap -sC -sV -p 21,22,139,445,3128,3333 &lt;direcci√≥n IP&gt; -oN targeted
</code></pre></div></div>

<p>A continuaci√≥n se explican los par√°metros utilizados en el escaneo de versiones y servicios con <em>Nmap</em>:</p>

<ul>
  <li>sC - Scripts b√°sicos de enumeraci√≥n</li>
  <li>sV - Versi√≥n y servicios que corren bajo los puertos encontrados</li>
  <li>p - Especificamos que puertos queremos analizar (los que encontramos abiertos en el paso anterior)</li>
  <li>oN - Exportar el escaneo en formato <em>Nmap</em></li>
</ul>

<p>Con estos dos escaneos bastar√° para responder a las preguntas planteadas con anterioridad, sin embargo nos quedan dos preguntas m√°s, las cuales son:</p>

<ul>
  <li>¬øCu√°ntos puertos se escanear√°n si utilizamos el par√°metro -p-400?</li>
  <li>Utilizando el par√°metro -n, ¬øqu√© no se est√° resolviendo?</li>
</ul>

<p>Para responder a estas dos preguntas bastar√° con haber le√≠do el <code class="language-plaintext highlighter-rouge">manual</code> de <em>Nmap</em>, o bien, haber utilizado su par√°metro <code class="language-plaintext highlighter-rouge">--help</code>. En este caso, si colocamos un n√∫mero despu√©s de <code class="language-plaintext highlighter-rouge">-p-</code>, se escanear√° tantos puertos hayamos indicado; y en el caso del par√°metro <code class="language-plaintext highlighter-rouge">-n</code>, no se aplicar√° resoluci√≥n DNS.</p>

<p>Una vez hemos determinado que puertos est√°n abiertos, as√≠ como identificado la versi√≥n y servicios que corren en el activo, otro paso importante dentro de la fase de reconocimiento, es el <em>fuzzing</em>; cabe aclarar que este solo se realiza cuando la m√°quina v√≠ctima est√° corriendo un servidor web.</p>

<p><em>Try Hack Me</em> nos recomienda utilizar <em>GoBuster</em>, sin embargo, prefiero personalmente el uso de <em>Wfuzz</em>; en caso de no contar con esta herramienta instalada, bastar√° con realizar lo siguiente:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo apt install wfuzz
</code></pre></div></div>

<p>Para pasar a la fase de explotaci√≥n, lo que nos solicita la plataforma es encontrar una ruta potencial de la p√°gina web, que nos permita una subida de archivos, para lo cual debemos de <em>fuzzear</em> la p√°gina web, para ello realizaremos lo siguiente:</p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2021-09-27-Vulnversity---Try-Hack-Me/2.png" alt="" /></p>

<p>Como podemos observar, existen cinco direcciones a las cuales podemos acceder, sin embargo, solamente una de ellas llama nuestra atenci√≥n, la direcci√≥n <code class="language-plaintext highlighter-rouge">internal</code>, ya que en <em>images</em>, <em>css</em>, <em>js</em> y <em>fonts</em> parece ser donde est√° alojado el contenido de la p√°gina web. Y en efecto, al entrar en la direcci√≥n <code class="language-plaintext highlighter-rouge">internal</code>, podemos observar que tenemos un panel que nos permite realizar una subida de archivos, con la cual nos entablaremos una <em>reverse shell</em>.</p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2021-09-27-Vulnversity---Try-Hack-Me/3.png" alt="" /></p>

<h3 id="fase-de-explotaci√≥n"><a href="#header-3"></a>Fase De Explotaci√≥n</h3>

<p>Al encontrarnos una ruta potencial que nos permite una subida de archivos, lo primero que vamos a intentar es entablarnos una <em>reverse shell</em>; podemos descargar una <a href="https://pentestmonkey.net/tools/web-shells/php-reverse-shell">aqu√≠</a>. Una vez la hayamos descargado, tenemos que modificar un valor, el de la <em>direcci√≥n IP</em>, y si queremos, el valor del <em>puerto</em> tambi√©n.</p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2021-09-27-Vulnversity---Try-Hack-Me/4.png" alt="" /></p>

<p>Sin embargo, cuando intentamos subir nuestra <em>reverse shell</em>, nos aparecer√° un mensaje indic√°ndonos que la extensi√≥n de nuestro archivo no es permitida.</p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/asse  ts/2021-09-27-Vulnversity---Try-Hack-Me/5.png" alt="" /></p>

<p>Por lo que tendremos que buscar una extensi√≥n que no nos de problema alguno. Si realizaramos este proceso de forma manual, ser√≠a algo bastante tedioso, por lo que vamos a utilizar <em>Burpsuite</em> para poder realizar una ataque de tipo <em>Sniper</em>.</p>

:ET